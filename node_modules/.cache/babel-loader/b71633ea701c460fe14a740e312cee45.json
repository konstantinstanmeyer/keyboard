{"ast":null,"code":"import _slicedToArray from\"/Users/konstantinstanmeyer/Development/code/projects/keyboard/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{Chart,Line}from'react-chartjs-2';import{Chart as ChartJS,LineElement,CategoryScale,LinearScale,PointElement}from'chart.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";ChartJS.register(LineElement,CategoryScale,LinearScale,PointElement);ChartJS.defaults.color=\"#22c55e\";export default function ProfileExists(_ref){var current_user=_ref.current_user;var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),avatarLoading=_useState4[0],setAvatarLoading=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),highScore=_useState6[0],setHighScore=_useState6[1];var _useState7=useState({file:null}),_useState8=_slicedToArray(_useState7,2),avatar=_useState8[0],setAvatar=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),image=_useState10[0],setImage=_useState10[1];var _useState11=useState({labels:[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"last\"],datasets:[{data:[],backgroundColor:\"transparent\",borderColor:\"#047857\",pointBorderColor:\"transparent\",pointBorderWidth:4,scaleFontColor:\"#047857\"}]}),_useState12=_slicedToArray(_useState11,2),data=_useState12[0],setData=_useState12[1];var options={plugins:{legend:false},scales:{x:{grid:{display:false}},y:{ticks:{stepSize:20,callback:function callback(value){return value+\"WPM\";}}}}};useEffect(function(){if(avatar.file!==null){var imageUrl=URL.createObjectURL(avatar);setImage(imageUrl);}},[avatar]);useEffect(function(){setIsLoading(true);fetch(\"http://localhost:3000/users/scores/\".concat(current_user.id),{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(r){return r.json();}).then(function(scores){var scoresArray=[];var dataScores=scores;scores.forEach(function(score){scoresArray.push(parseFloat(score.score));});data.datasets[0].data=dataScores.map(function(value){return value.score;}).slice(-10);setHighScore(Math.max.apply(Math,scoresArray));setIsLoading(false);});},[]);function handleAvatarSubmit(e){e.preventDefault();if(avatar!==null){var form=new FormData();form.append(\"avatar\",avatar);fetch(\"http://localhost:3000/avatar\",{method:\"post\",headers:{Authorization:localStorage.getItem(\"token\")},body:form}).then(function(res){if(res.ok){document.location.reload();return res.json();}else{throw new Error(res);}});}else{alert(\"no file has been attached\");}}console.log(data.labels);console.log(avatar);return/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-2/5 mt-14 z-20 rounded-xl justify-center mx-auto flex flex-col h-fit bg-sky-900\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row items-center justify-center relative mt-6 mb-6\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"h-32 w-32 object-cover border-4 border-emerald-500\",src:avatar.file!==null?image:current_user.avatar_url?current_user.avatar_url:\"https://avatars.githubusercontent.com/u/35440139?v=4}\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4 flex flex-col h-full w-1/3\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-emerald-500\",children:[current_user.username,\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs\",children:[\"Origin: \",current_user.origin?current_user.origin:\"N/A\"]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-emerald-500 mb-1\",children:[\"Highscore: \",highScore===-Infinity?0:highScore,\" WPM\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"relative w-full\",children:avatar.file!==null?/*#__PURE__*/_jsx(\"button\",{className:\"w-fit bg-emerald-500 px-2 rounded-md text-sky-900 font-bold\",onClick:function onClick(e){return handleAvatarSubmit(e);},children:\"submit avatar\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setAvatar(e.target.files[0]);},id:\"file\",placeholder:\"yes\",type:\"file\",name:\"avatar\",className:\"w-fit hidden\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-md font-bold text-sky-900 bg-emerald-500 rounded-md px-2 py-[2.5px] hover:cursor-pointer\",for:\"file\",children:\"change your avatar\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return navigate('/profile/edit');},className:\"bg-emerald-500 text-sky-900 px-2 rounded-md mt-2 w-fit hover:bg-emerald-300 font-bold\",children:\"settings\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-center text-lg underline underline-offset-4 italic text-emerald-500\",children:\"previous ten rounds\"}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:isLoading?null:/*#__PURE__*/_jsx(Line,{className:\"p-10\",data:data,options:options})})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","Chart","Line","ChartJS","LineElement","CategoryScale","LinearScale","PointElement","register","defaults","color","ProfileExists","current_user","navigate","isLoading","setIsLoading","avatarLoading","setAvatarLoading","highScore","setHighScore","file","avatar","setAvatar","image","setImage","labels","datasets","data","backgroundColor","borderColor","pointBorderColor","pointBorderWidth","scaleFontColor","setData","options","plugins","legend","scales","x","grid","display","y","ticks","stepSize","callback","value","imageUrl","URL","createObjectURL","fetch","id","headers","Authorization","localStorage","getItem","then","r","json","scores","scoresArray","dataScores","forEach","score","push","parseFloat","map","slice","Math","max","handleAvatarSubmit","e","preventDefault","form","FormData","append","method","body","res","ok","document","location","reload","Error","alert","console","log","avatar_url","username","origin","Infinity","target","files"],"sources":["/Users/konstantinstanmeyer/Development/code/projects/keyboard/frontend/src/ProfileExists.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Chart, Line } from 'react-chartjs-2';\nimport {\n    Chart as ChartJS,\n    LineElement,\n    CategoryScale,\n    LinearScale,\n    PointElement\n} from 'chart.js';\n\nChartJS.register(\n    LineElement,\n    CategoryScale,\n    LinearScale,\n    PointElement\n)\n\nChartJS.defaults.color = \"#22c55e\";\n\nexport default function ProfileExists({ current_user }){\n    const navigate = useNavigate();\n    const [isLoading, setIsLoading] = useState(false)\n    const [avatarLoading, setAvatarLoading] = useState(false)\n    const [highScore, setHighScore] = useState(0)\n    const [avatar, setAvatar] = useState({\n        file:null\n    })\n    const [image, setImage] = useState(\"\")\n\n    const [data, setData] = useState({\n        labels: [\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"last\"],\n        datasets: [{\n            data: [],\n            backgroundColor: \"transparent\",\n            borderColor:  \"#047857\",\n            pointBorderColor: \"transparent\",\n            pointBorderWidth: 4,\n            scaleFontColor: \"#047857\",\n        }],\n    })\n\n    const options = {\n        plugins: {\n            legend: false\n        },\n        scales: {\n            x: {\n                grid: {\n                    display: false,\n                }\n            },\n            y: {\n                ticks: {\n                    stepSize: 20,\n                    callback: (value) => (value) + \"WPM\"\n                }\n            }\n        }\n    }\n\n    useEffect(() => {\n        if(avatar.file !== null){\n            const imageUrl = URL.createObjectURL(avatar)\n            setImage(imageUrl)\n        }\n    }, [avatar])\n\n    useEffect(() => {\n        setIsLoading(true)\n        fetch(`http://localhost:3000/users/scores/${current_user.id}`, {\n        headers: {\n            Authorization: localStorage.getItem(\"token\")\n        }\n        })\n        .then(r => r.json())\n        .then(scores => {\n            let scoresArray = [];\n            let dataScores = scores;\n            scores.forEach((score) => {\n                scoresArray.push(parseFloat(score.score));\n            })\n            data.datasets[0].data = dataScores.map((value) => {\n                return value.score;\n            }).slice(-10)\n            setHighScore(Math.max(...scoresArray))\n            setIsLoading(false)\n        })\n    }, [])\n\n    function handleAvatarSubmit(e){\n        e.preventDefault();\n\n        if (avatar !== null){\n            const form = new FormData();\n            form.append(\"avatar\", avatar)\n            fetch(\"http://localhost:3000/avatar\", {\n            method: \"post\",\n            headers: {\n                Authorization: localStorage.getItem(\"token\"),\n            },\n            body: form,\n            })\n            .then((res) => {\n                if (res.ok) {\n                document.location.reload()\n                return res.json();\n                } else {\n                throw new Error(res);\n                }\n            })\n        } else {\n            alert(\"no file has been attached\")\n        }\n    }\n\n    console.log(data.labels)\n\n    console.log(avatar)\n\n    return (\n        <div className=\"relative w-2/5 mt-14 z-20 rounded-xl justify-center mx-auto flex flex-col h-fit bg-sky-900\">\n            <div className=\"flex flex-row items-center justify-center relative mt-6 mb-6\">\n                <img className=\"h-32 w-32 object-cover border-4 border-emerald-500\" src={avatar.file !== null ? image : current_user.avatar_url ? current_user.avatar_url : \"https://avatars.githubusercontent.com/u/35440139?v=4}\"}/>\n                    <div className=\"ml-4 flex flex-col h-full w-1/3\">\n                        <h3 className=\"text-emerald-500\">{current_user.username} <span className=\"text-xs\">Origin: {current_user.origin ? current_user.origin : \"N/A\"}</span></h3>\n                        <p className=\"text-emerald-500 mb-1\">Highscore: {highScore === -Infinity ? 0 : highScore} WPM</p>\n                        <div className=\"relative w-full\">\n                                {avatar.file !== null ? <button className=\"w-fit bg-emerald-500 px-2 rounded-md text-sky-900 font-bold\" onClick={(e) => handleAvatarSubmit(e)}>submit avatar</button> : \n                                    <>\n                                        <input onChange={(e) => setAvatar(e.target.files[0])} id=\"file\" placeholder=\"yes\" type=\"file\" name=\"avatar\" className=\"w-fit hidden\"  />\n                                        <label className=\"text-md font-bold text-sky-900 bg-emerald-500 rounded-md px-2 py-[2.5px] hover:cursor-pointer\" for=\"file\">change your avatar</label>\n                                    </>\n                                }\n                        </div>\n                        <button onClick={() => navigate('/profile/edit')} className=\"bg-emerald-500 text-sky-900 px-2 rounded-md mt-2 w-fit hover:bg-emerald-300 font-bold\">settings</button>\n                    </div>\n            </div>\n            <h2 className=\"text-center text-lg underline underline-offset-4 italic text-emerald-500\">previous ten rounds</h2>\n            <div className=\"\">\n                {isLoading ? null : <Line className=\"p-10\" data={data} options={options} />}\n            </div>\n        </div>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}